<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>In tuned · Administrative Site</title>

    <!-- Favicon and app icons -->
    <link rel="icon" href="/favicon.ico" sizes="48x48" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <meta name="theme-color" content="#2563eb" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <style>
      /* Admin layout, built to reuse core site styles */

      body {
        margin: 0;
        font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", sans-serif;
      }

      .adminWrap {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      .adminMain {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 24px 16px 40px;
      }

      .adminFooter {
        text-align: center;
        padding: 12px 16px 20px;
        font-size: 0.8rem;
        opacity: 0.8;
      }

      .adminTopbar {
        justify-content: center;
      }

      .adminTopbar .brand {
        margin: 12px auto 0;
      }

      .adminTopbar .brandText {
        text-align: center;
      }

      .adminTopbar .brandText .subtitle {
        font-size: 0.85rem;
        opacity: 0.8;
        margin-top: 2px;
      }

      .adminCard {
        width: 100%;
        max-width: 460px;
      }

      .adminCard h1 {
        margin-top: 0;
        margin-bottom: 6px;
        font-size: 1.5rem;
      }

      .adminCard p.subtle {
        margin-top: 0;
        margin-bottom: 18px;
        font-size: 0.9rem;
        opacity: 0.8;
      }

      .fieldGroup {
        margin-bottom: 16px;
      }

      .loadingBarLabel {
        font-size: 0.9rem;
        margin-bottom: 8px;
        text-align: center;
      }

      .loadingBar {
        position: relative;
        width: 100%;
        height: 8px;
        border-radius: 999px;
        overflow: hidden;
      }

      .loadingBarFill {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 0%;
        border-radius: inherit;
        transition: width 3s ease-out;
      }

      .adminDashboard {
        width: 100%;
        max-width: 1080px;
        display: none;
        flex-direction: column;
        gap: 24px;
      }

      .adminDashboardHeader {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
      }

      .adminDashboardHeader h2 {
        margin: 0;
        font-size: 1.3rem;
      }

      .adminSectionRow {
        display: grid;
        grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.4fr);
        gap: 20px;
      }

      @media (max-width: 768px) {
        .adminSectionRow {
          grid-template-columns: minmax(0, 1fr);
        }
      }

      .adminPanel h3 {
        margin-top: 0;
        margin-bottom: 8px;
        font-size: 1.05rem;
      }

      .adminPanel p.helper {
        margin-top: 0;
        margin-bottom: 14px;
        font-size: 0.86rem;
        opacity: 0.8;
      }

      .toggleRow {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        margin: 8px 0 10px;
      }

      .toggleLabel {
        font-size: 0.95rem;
      }

      .toggleSwitch {
        position: relative;
        width: 52px;
        height: 28px;
      }

      .toggleSwitch input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .toggleTrack {
        position: absolute;
        inset: 0;
        border-radius: 999px;
        cursor: pointer;
        transition: background-color 0.2s ease, box-shadow 0.2s ease;
      }

      .toggleThumb {
        position: absolute;
        top: 2px;
        left: 2px;
        width: 22px;
        height: 22px;
        border-radius: 50%;
        transition: transform 0.2s ease;
      }

      .toggleSwitch input:checked + .toggleTrack .toggleThumb {
        transform: translateX(22px);
      }

      .chip {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 0.8rem;
      }

      .chip.offline {
        opacity: 0.85;
      }

      .fileList {
        margin-top: 10px;
        max-height: 200px;
        overflow-y: auto;
        border-radius: 10px;
        padding: 6px 8px;
        font-size: 0.82rem;
      }

      .fileRow {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 10px;
        padding: 4px 2px;
      }

      .fileRow + .fileRow {
        border-top-width: 1px;
        border-top-style: solid;
      }

      .fileRowMain {
        display: flex;
        flex-direction: column;
      }

      .fileRowMain span.language {
        font-size: 0.76rem;
        opacity: 0.8;
      }

      .noticeList {
        margin-top: 8px;
        max-height: 180px;
        overflow-y: auto;
        border-radius: 10px;
        padding: 6px 8px;
        font-size: 0.82rem;
      }

      .noticeRow + .noticeRow {
        border-top-width: 1px;
        border-top-style: solid;
      }

      .noticeRow {
        padding: 4px 2px;
        display: flex;
        justify-content: space-between;
        gap: 8px;
      }

      .noticeMain {
        display: flex;
        flex-direction: column;
      }

      .badge {
        display: inline-flex;
        align-items: center;
        padding: 2px 7px;
        border-radius: 999px;
        font-size: 0.7rem;
      }

      .badge.inactive {
        opacity: 0.75;
      }

      .sectionFooter {
        margin-top: 10px;
        font-size: 0.78rem;
        opacity: 0.8;
      }

      /* Centered loading overlay after successful login */

      .adminLoadingOverlay {
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 40;
      }

      .adminLoadingOverlay.show {
        display: flex;
      }

      .adminLoadingCard {
        width: 100%;
        max-width: 360px;
        text-align: center;
      }

      .adminLoadingCard .loadingTitle {
        margin-top: 0;
        margin-bottom: 12px;
        font-size: 1rem;
      }

      .adminLoadingCard .loadingBar {
        margin-top: 4px;
      }

      /* Developer password modal uses existing overlay/modal styling,
         this only adjusts minor layout */

      .devPasswordCard {
        width: 100%;
        max-width: 380px;
      }

      .devPasswordActions {
        margin-top: 16px;
        display: flex;
        justify-content: flex-end;
        gap: 10px;
      }

      .hidden {
        display: none !important;
      }

      /* Feedback section styles */
      .feedbackStatsRow {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 0.9rem;
      }

      .feedbackStatItem {
        display: flex;
        align-items: center;
        gap: 0.4rem;
      }

      .feedbackStatLabel {
        font-size: 0.88rem;
        opacity: 0.8;
      }

      .feedbackStatValue {
        font-size: 1.05rem;
        font-weight: 700;
        padding: 0.25rem 0.7rem;
        background: rgba(37, 99, 235, 0.12);
        border-radius: 8px;
      }

      .feedbackActions {
        display: flex;
        gap: 0.6rem;
        margin-bottom: 0.75rem;
      }

      /* Feedback view modal */
      .feedbackViewModal {
        max-width: 720px;
        max-height: 85vh;
        display: flex;
        flex-direction: column;
      }

      .feedbackViewHeader {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.85rem;
        padding-bottom: 0.65rem;
        border-bottom: 1px solid rgba(148, 163, 184, 0.35);
      }

      .feedbackViewHeader h3 {
        margin: 0;
        font-size: 1.15rem;
        font-weight: 700;
      }

      .feedbackViewContent {
        flex: 1;
        overflow-y: auto;
        max-height: 55vh;
        padding-right: 0.4rem;
      }

      .noFeedback {
        font-size: 0.92rem;
        opacity: 0.7;
        text-align: center;
        padding: 2rem 0;
      }

      .feedbackEntry {
        background: rgba(15, 23, 42, 0.5);
        border: 1px solid rgba(148, 163, 184, 0.35);
        border-radius: 12px;
        padding: 0.9rem 1.05rem;
        margin-bottom: 0.75rem;
      }

      .feedbackEntry:last-child {
        margin-bottom: 0;
      }

      .feedbackEntryHeader {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.7rem;
        padding-bottom: 0.55rem;
        border-bottom: 1px solid rgba(148, 163, 184, 0.25);
      }

      .feedbackEntryNumber {
        font-size: 0.9rem;
        font-weight: 700;
        color: #60a5fa;
      }

      .feedbackEntryDate {
        font-size: 0.78rem;
        opacity: 0.7;
      }

      .feedbackEntrySection {
        margin-bottom: 0.65rem;
      }

      .feedbackEntrySection:last-child {
        margin-bottom: 0;
      }

      .feedbackEntrySectionLabel {
        display: block;
        font-size: 0.76rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.06em;
        opacity: 0.7;
        margin-bottom: 0.3rem;
      }

      .feedbackEntryText,
      .feedbackEntryAnalysis,
      .feedbackEntryUserFeedback {
        margin: 0;
        font-size: 0.88rem;
        line-height: 1.55;
      }

      .feedbackEntryText {
        padding: 0.5rem 0.7rem;
        background: rgba(15, 23, 42, 0.6);
        border-radius: 8px;
        border: 1px solid rgba(148, 163, 184, 0.25);
      }

      .feedbackEntryAnalysis {
        font-weight: 500;
      }

      .feedbackEntryMixture {
        display: flex;
        flex-wrap: wrap;
        gap: 0.4rem;
        margin-top: 0.4rem;
      }

      .feedbackMixtureItem {
        font-size: 0.78rem;
        padding: 0.22rem 0.55rem;
        background: rgba(15, 23, 42, 0.5);
        border: 1px solid rgba(148, 163, 184, 0.25);
        border-radius: 6px;
        opacity: 0.85;
      }

      .feedbackEntryFeedback {
        background: rgba(37, 99, 235, 0.08);
        padding: 0.65rem 0.8rem;
        border-radius: 8px;
        border: 1px solid rgba(37, 99, 235, 0.18);
      }

      .feedbackViewActions {
        display: flex;
        justify-content: flex-end;
        gap: 0.6rem;
        margin-top: 0.95rem;
        padding-top: 0.75rem;
        border-top: 1px solid rgba(148, 163, 184, 0.35);
      }
    </style>
  </head>
  <body>
    <div class="wrap adminWrap">
      <header class="topbar adminTopbar">
        <div class="brand" aria-label="In tuned home">
          <div class="logo" aria-hidden="true">
            <div class="mark" aria-hidden="true"></div>
          </div>
          <div class="brandText">
            <div class="title">In tuned</div>
            <div class="subtitle">Administrative site</div>
          </div>
        </div>
      </header>

      <main class="adminMain">
        <!-- Login view -->
        <section id="admin-login-view" class="card adminCard">
          <h1>Administrative access</h1>
          <p class="subtle">
            Sign in with the administrative credentials to manage maintenance,
            lexicons, and notices.
          </p>

          <form id="admin-login-form" novalidate>
            <div class="fieldGroup">
              <label class="fieldLabel" for="admin-username">Username</label>
              <input
                id="admin-username"
                class="fieldInput"
                type="text"
                autocomplete="username"
                placeholder="Enter admin username"
              />
            </div>

            <div class="fieldGroup">
              <label class="fieldLabel" for="admin-password">Password</label>
              <input
                id="admin-password"
                class="fieldInput"
                type="password"
                autocomplete="current-password"
                placeholder="Enter admin password"
              />
              <p id="admin-login-error" class="errorText hidden">
                Not authorized
              </p>
            </div>

            <button
              id="admin-login-button"
              type="submit"
              class="btn primaryBtn"
            >
              Login
            </button>
          </form>
        </section>

        <!-- Dashboard view -->
        <section id="admin-dashboard" class="adminDashboard">
          <div class="adminDashboardHeader">
            <h2>Welcome, Ryan</h2>
            <button id="admin-logout-button" class="ghost">
              Logout
            </button>
          </div>

          <div class="adminSectionRow">
            <!-- Developer Updates / Maintenance -->
            <section class="card adminPanel">
              <h3>Developer updates</h3>
              <p class="helper">
                Control the maintenance banner and site availability message.
              </p>

              <div class="toggleRow">
                <div>
                  <div class="toggleLabel">
                    Site is currently down due to maintenance
                  </div>
                  <div
                    id="maintenance-status-chip"
                    class="chip offline"
                  >
                    Offline
                  </div>
                </div>
                <label class="toggleSwitch">
                  <input
                    id="maintenance-toggle"
                    type="checkbox"
                    aria-label="Toggle maintenance mode"
                  />
                  <div class="toggleTrack">
                    <div class="toggleThumb"></div>
                  </div>
                </label>
              </div>

              <div class="fieldGroup">
                <label class="fieldLabel" for="maintenance-message">
                  Maintenance message
                </label>
                <textarea
                  id="maintenance-message"
                  class="fieldInput"
                  style="min-height: 70px; resize: vertical;"
                  placeholder="Site is currently down due to maintenance. We will be back shortly."
                ></textarea>
              </div>

              <p id="maintenance-error" class="errorText hidden"></p>

              <div class="sectionFooter">
                Turning maintenance on requires the developer password. Turning
                it off does not.
              </div>
            </section>

            <!-- Notices -->
            <section class="card adminPanel">
              <h3>Notices</h3>
              <p class="helper">
                Add a notice that appears under the logo on the main site. If
                there is no active notice, nothing will be shown.
              </p>

              <div class="fieldGroup">
                <label class="fieldLabel" for="notice-text">
                  New notice text
                </label>
                <textarea
                  id="notice-text"
                  class="fieldInput"
                  style="min-height: 70px; resize: vertical;"
                  placeholder="Type a short notice to display under the logo."
                ></textarea>
              </div>

              <div
                class="fieldGroup"
                style="display: flex; align-items: center; gap: 8px;"
              >
                <input
                  id="notice-active"
                  type="checkbox"
                  checked
                  style="width: 16px; height: 16px;"
                />
                <label
                  for="notice-active"
                  class="fieldLabel"
                  style="margin: 0;"
                >
                  Set as active notice
                </label>
              </div>

              <button id="add-notice-button" class="btn primaryBtn">
                Add notice
              </button>

              <p id="notice-error" class="errorText hidden"></p>

              <div id="notice-list" class="noticeList"></div>

              <div class="sectionFooter">
                Only one notice is active at a time. Older notices are kept for
                reference.
              </div>
            </section>
          </div>

          <div class="adminSectionRow">
            <!-- Lexicons -->
            <section class="card adminPanel">
              <h3>Lexicons</h3>
              <p class="helper">
                Upload or remove lexicon files for English, Spanish, and
                Portuguese. These files are available to the detector as
                dictionaries and data sets.
              </p>

              <form
                id="lexicon-upload-form"
                enctype="multipart/form-data"
                novalidate
              >
                <div class="fieldGroup">
                  <label class="fieldLabel" for="lexicon-language">
                    Language
                  </label>
                  <select
                    id="lexicon-language"
                    class="fieldInput"
                    style="padding-right: 30px;"
                  >
                    <option value="en">English</option>
                    <option value="es">Spanish</option>
                    <option value="pt">Portuguese</option>
                  </select>
                </div>

                <div class="fieldGroup">
                  <label class="fieldLabel" for="lexicon-file">
                    Lexicon file
                  </label>
                  <input
                    id="lexicon-file"
                    class="fieldInput"
                    type="file"
                    accept=".pdf,.json,.txt,.csv"
                  />
                </div>

                <button
                  id="upload-lexicon-button"
                  type="submit"
                  class="btn primaryBtn"
                >
                  Upload lexicon
                </button>
              </form>

              <p id="lexicon-error" class="errorText hidden"></p>

              <div id="lexicon-file-list" class="fileList"></div>

              <div class="sectionFooter">
                Large lexicons are stored in Postgres. The detector can load the
                newest file for each language during analysis.
              </div>
            </section>

            <!-- Feedback section -->
            <section class="card adminPanel">
              <h3>Feedback</h3>
              <p class="helper">
                Review anonymous user feedback about analysis accuracy.
                This feedback helps refine the emotion detector.
              </p>

              <div class="feedbackStatsRow">
                <div class="feedbackStatItem">
                  <span class="feedbackStatLabel">Total feedback entries:</span>
                  <span id="feedback-count" class="feedbackStatValue">0</span>
                </div>
              </div>

              <div class="feedbackActions">
                <button
                  id="view-feedback-button"
                  class="btn secondaryBtn"
                  type="button"
                >
                  View Feedback
                </button>
                <button
                  id="download-feedback-button"
                  class="btn primaryBtn"
                  type="button"
                >
                  Download
                </button>
              </div>

              <p id="feedback-error" class="errorText hidden"></p>

              <div class="sectionFooter">
                After downloading, the feedback document will be deleted to
                keep the database clean. A new document will be created as
                new feedback is submitted.
              </div>
            </section>
          </div>

          <div class="adminSectionRow">
            <!-- Simple confirmation panel -->
            <section class="card adminPanel">
              <h3>Admin notes</h3>
              <p class="helper">
                This panel is reserved for future tools and metrics. For now it
                simply confirms that you are authenticated as the administrator.
              </p>
              <p style="font-size: 0.9rem; opacity: 0.85;">
                Logged in as
                <strong>Admin</strong>.
              </p>
            </section>
          </div>
        </section>
      </main>

      <footer class="adminFooter">
        © 2025 In tuned. All rights reserved.
      </footer>
    </div>

    <!-- Centered loading overlay shown after successful login -->
    <div
      id="admin-loading-overlay"
      class="adminLoadingOverlay"
      role="status"
      aria-live="polite"
    >
      <div class="card adminLoadingCard">
        <p class="loadingTitle">Welcome, Ryan. Loading admin tools.</p>
        <div class="loadingBar">
          <div
            id="admin-loading-fill"
            class="loadingBarFill"
          ></div>
        </div>
      </div>
    </div>

    <!-- Developer password modal -->
    <div
      id="dev-password-modal"
      class="overlay"
      role="dialog"
      aria-modal="true"
      aria-labelledby="devPasswordTitle"
    >
      <div class="modal authModal devPasswordCard">
        <h3 id="devPasswordTitle">Enable maintenance</h3>
        <p class="helper">
          Enter the developer password to turn on maintenance mode.
        </p>

        <div class="fieldGroup">
          <label class="fieldLabel" for="dev-password-input">
            Developer password
          </label>
          <input
            id="dev-password-input"
            class="fieldInput"
            type="password"
            autocomplete="off"
          />
          <p id="dev-password-error" class="errorText hidden"></p>
        </div>

        <div class="devPasswordActions">
          <button id="dev-password-cancel" class="ghost">
            Cancel
          </button>
          <button
            id="dev-password-confirm"
            class="btn primaryBtn"
            style="width: auto;"
          >
            Confirm
          </button>
        </div>
      </div>
    </div>

    <!-- Feedback view modal -->
    <div
      id="feedback-view-modal"
      class="overlay"
      role="dialog"
      aria-modal="true"
      aria-labelledby="feedbackViewTitle"
    >
      <div class="modal feedbackViewModal">
        <div class="feedbackViewHeader">
          <h3 id="feedbackViewTitle">Feedback Document</h3>
          <button id="close-feedback-view" class="ghost" type="button">
            Close
          </button>
        </div>
        <div id="feedback-view-content" class="feedbackViewContent">
          <p class="noFeedback">No feedback entries yet.</p>
        </div>
        <div class="feedbackViewActions">
          <button
            id="download-from-view-button"
            class="btn primaryBtn"
            type="button"
          >
            Download Document
          </button>
        </div>
      </div>
    </div>

    <script src="admin.js"></script>
  </body>
</html>
